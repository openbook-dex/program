# Openbook DEX

## Testing 

### Run unit tests

```bash
cargo test
```

## Run fuzz tests

```bash
cargo install cargo-fuzz
cargo fuzz run multiple_orders
```

If this doesn't work, you may need to switch to the nightly version of the Rust compiler:

```bash
rustup toolchain install nightly
rustup override set nightly
```

## Deploying

### Compiling

```bash
cargo build-bpf
```

### Deploying locally

```bash
solana config set -u localhost
solana-test-validator
# generate a key & give yourself some SOL if you haven't already
solana-keygen new
solana airdrop 100
solana program deploy target/deploy/serum_dex.so
```

### Deploying remotely

```
solana config set -u devnet # options are mainnet-beta, testnet, & devnet
# verify that you have SOL balances for gas
KEYPAIR=~/.config/solana/id.json
solana balance -k $KEYPAIR
solana program deploy target/deploy/serum_dex.so
```

## Using the crank client utility

```bash
cd crank

# read the autogenerated help text
cargo run -- help

# supported options are localnet, mainnet, testnet, devnet
CLUSTER=localnet

# verify that you have SOL balances for gas
KEYPAIR=~/.config/solana/id.json
solana balance -k $KEYPAIR

# run the demo script (this is mostly a smoke test)
cargo run -- $CLUSTER whole-shebang $KEYPAIR $DEX_PROGRAM_ID

# list a market with the default tick size and minimum quantity.
# if both assets have 6 decimals, this will be a quantity of 1 and a tick size of 0.01
COIN_MINT="..."
PRICE_CURRENCY_MINT="..."
cargo run -- $CLUSTER list-market $KEYPAIR $DEX_PROGRAM_ID --coin-mint $COIN_MINT --pc-mint $PRICE_CURRENCY_MINT
```
